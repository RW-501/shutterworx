<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join ShutterWorx</title>
    <!-- Bootstrap CSS for styling -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/main.css">

    <style>
        .membership-card {
            border: 1px solid #dee2e6;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .membership-card:hover {
            transform: scale(1.05);
        }

        .pricing-header {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .membership-price {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
        }

        .features-list {
            text-align: left;
            padding: .5rem;
        }

        .join-button {
            margin-top: 1.5rem;
        }
.features-list li {
    list-style: circle;
    padding: .2rem;
    
}

.membership-card h3 {
    color:  #1a237e;

}

.membership-price {
    color: #2733bb;

}
        @media (max-width: 768px) {
            .membership-card {
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header id="site-header">
        <h1 id="header-title">Join ShutterWorx</h1>
        <p id="header-subtitle">Your gateway to exclusive photography services and community!</p>
        <nav id="nav-menu">
            <ul>
                <li><a href="../shutterWorx/" aria-label="Home">Home</a></li>
                <li><a href="../shutterWorx/join" aria-label="Join Now">Join Now</a></li>
                <li><a href="../shutterWorx/FAQ" aria-label="FAQ">FAQ</a></li>
                <li><a href="../shutterWorx/contact" aria-label="Contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="container mt-5">
            <div class="row">
                <!-- Basic Membership Card -->
                <div class="col-md-4">
                    <div class="membership-card">
                        <h3 class="pricing-header">Basic Membership</h3>
                        <p class="membership-price">$29/month</p>
                        <ul class="list-unstyled features-list">
                            <li>Standard features</li>
                            <li>Standard watermark for photos</li>
                            <li>Customizable Pages (Home, Events, Portfolio, Contact)</li>
                            <li>SEO features to optimize visibility</li>
                            <li>Sell photos online (Powered by Stripe)</li>
                            <li>Transaction logs for tracking sales</li>
                            <li>Access code for private events</li>
                            <li>5 events allowed per month</li>
                            <li>20 images per event</li>
                            <li>Limited customer support</li>
                        </ul>
                        <button class="btn btn-primary join-button" onclick="window.location.href='../shutterWorx/signup/-basic'">Join Now</button>
                    </div>
                </div>
        
                <!-- Pro Membership Card -->
                <div class="col-md-4">
                    <div class="membership-card">
                        <h3 class="pricing-header">Pro Membership</h3>
                        <p class="membership-price">$49/month</p>
                        <ul class="list-unstyled features-list">
                            <li>All Basic Membership features</li>
                            <li>Customizable watermark for photos</li>
                            <li>Built-in photo editor for quick edits</li>
                            <li>QR code generator for easy event sharing</li>
                            <li>Help Bot for instant support</li>
                            <li>20 events allowed per month</li>
                            <li>50 images per event</li>
                            <li>Priority customer support</li>
                            <li>Exclusive content and features</li>
                        </ul>
                        <button class="btn btn-primary join-button" onclick="window.location.href='../shutterWorx/signup-pro'">Join Now</button>
                    </div>
                </div>
        
                <!-- Elite Membership Card -->
                <div class="col-md-4">
                    <div class="membership-card">
                        <h3 class="pricing-header">Elite Membership</h3>
                        <p class="membership-price">$99/month</p>
                        <ul class="list-unstyled features-list">
                            <li>All Basic & Pro Membership features</li>
                            <li>Add unlimited additional pages to your site</li>
                            <li>Advanced event management tools</li>
                            <li>Social media plugins for easy sharing</li>
                            <li>Premium analytics for in-depth performance insights</li>
                            <li>Add multiple users to your account</li>
                            <li>Custom domain setup (coming soon)</li>
                            <li>Unlimited events and unlimited photo uploads</li>
                            <li>24/7 customer support</li>
                            <li>Personalized coaching sessions for growth</li>
                        </ul>
                        <button class="btn btn-primary join-button" onclick="window.location.href='../shutterWorx/signup-elite'">Join Now</button>
                    </div>
                </div>
            </div>
        </div>
        
        </div>

        <div class="mt-5 text-center">
            <p><small>Still have questions? <a href="../shutterWorx/contact" class="text-primary">Contact us</a> for more information.</small></p>
        </div>
    </main>

    <!-- Footer -->
    <footer id="site-footer">
        <div class="social-icons">
            <!-- Social media links dynamically added here -->
        </div>
        <footer-body>
            <p>&copy; 2024 <a href="../shutterWorx/" style="color: #fff;">ShutterWorx</a>/ TechNoob All Rights Reserved.</p>
            <p><small><a href="privacy" style="color: #fff;">Privacy Policy</a> | <a href="terms" style="color: #fff;">Terms of Service</a></small></p>
        </footer-body>
    </footer>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>



<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<script  type="module" src="../js/main.js"></script>
<script  type="module" src="../js/firebaseConfig.js"></script>


<!-- Include your firebaseConfig.js as a module -->
<script type="module">
    import {  db, doc,getDoc, query, updateDoc,
    setDoc,     signInWithPopup,
    GoogleAuthProvider,
    FacebookAuthProvider,
    OAuthProvider,arrayUnion ,
    signOut, addDoc , increment,
    onAuthStateChanged,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    where, getDocs, storage, collection, auth, analytics  } from '../js/firebaseConfig.js';

    




 

     




        let viewStartTime;

// Function to set the last internal page in sessionStorage before navigating
function setInternalPageSource() {
    sessionStorage.setItem('lastInternalPage', window.location.href);
}

// Function to start tracking the view time when the page loads
function startViewTimer() {
    viewStartTime = Date.now();
    //console.log("viewStartTime   ",viewStartTime);

}



    // Determine the source
    const externalSource = document.referrer && !document.referrer.includes(window.location.origin)
        ? document.referrer
        : null;
    const internalSource = sessionStorage.getItem('lastInternalPage');
    const viewSource = externalSource || internalSource || 'Direct Visit';



    let ipAddress;
let locationData;

document.addEventListener("DOMContentLoaded", async () => {
    try {
        const { ip, location } = await window.userLocationService.getUserIPAndLocation();

        ipAddress = ip;
        locationData = location;
    } catch (error) {
        console.error("Error fetching user IP and location:", error);
    }
});




    

 function updateViewData() {
    // Calculate view duration in seconds
    const viewEndTime = Date.now();
    const durationOfView = (viewEndTime - viewStartTime) / 1000; // Convert ms to seconds

    // Validate IP address before proceeding
    if (!ipAddress) {
        console.error("Missing IP address. View data not recorded.");
        return;
    }


    // Prepare the data to be updated
    const viewData = {
        JoinViewedBy: {
            viewDate: new Date().toISOString(),
            viewMethod: navigator.userAgentData?.mobile ? "mobile" : "desktop",
            durationOfView: (Date.now() - viewStartTime) / 1000,
            viewSource: viewSource
        },
        ipAddress: ipAddress,
        city: locationData.city,
        zipCode: locationData.zip,
        state: locationData.state,
        country: locationData.country,
        contactViews: increment(1)
    };

    console.log("viewData   ",viewData);

    // Update or create the job view data in the Jobs collection
    setDoc(doc(db, 'guest-ShutterWorx', ipAddress), viewData, { merge: true });
      //  console.log("Job view data updated successfully.");
 
}


// Event listener to set last internal page before navigating away
window.addEventListener('beforeunload', setInternalPageSource);

// Event listener to start timing the view when the page loads
window.addEventListener('load', startViewTimer);

// Event listener to record data when the page is unloaded
document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'hidden') {
        updateViewData();
    }
});

     
  
/*
setTimeout(() => {
    updateViewData();
}, 5000); // Close modal after 5 seconds
*/

</script>

</body>
</html>
